title=Herança de Projeto vs Agregação de Projeto
date=2011-06-15
type=post
tags=configuracao,maven
status=published
~~~~~~

<p><br /><strong><a href="http://maven.apache.org/pom.html#Inheritance">Requisito</a>:</strong> The packaging type required to be pom for parent and aggregation (multi-module) projects. <br /><strong>Tradução: </strong>para que você possa criar ou transformar um projeto em um que seja pai (PARENT) ou agregação (AGGREGATION), necessita-se definir seu empacotamento (PACKING) para pom, <a href="http://code.google.com/p/construtor/source/browse/trunk/park-samples/pom.xml">assim</a>:<br /><pre lang="xml"><br />    <modelVersion>4.0.0</modelVersion><br />    <groupId>com.google.constructor</groupId><br />    <artifactId>park-samples</artifactId><br />    <!--The packaging type required to be pom for parent and aggregation (multi-module) projects.--><br />    <packaging>pom</packaging><br />    <version>1.0-SNAPSHOT</version><br />    <name>Apache Click Park Samples Project</name><br />    <url>http://code.google.com/p/construtor</url><br />    <description><br />        A parent POM used for all the projects<br />    </description><br /></pre><br /></p><br /><p><br />Criei um <a href="http://code.google.com/p/construtor/">projeto hospedado no google</a> para armazenar códigos java - base de aprendizado na linguagem java, especialmente nas especificações Servlet e JPA.<br />Entre estes códigos, em especial, quero destacar o park-samples. <a href="http://code.google.com/p/construtor/source/browse/trunk/park-samples/README.txt">Este é estruturado utilizando tanto herança quanto agregação</a>:<br /><pre lang="bash"><br />gilberto@dhcppc0:~/dev/netbeans-config/park-samples> tree --dirsfirst -L 3<br />.<br />|-- docs<br />|   |-- evolus.pencil<br />|   |   |-- EditLegalEntity.ep<br />|   |   `-- EditNaturalPerson.ep<br />|   |-- power.architect<br />|   |   |-- park.architect<br />|   |   `-- park-er.pdf<br />|   |-- 03000001.png<br />|   `-- 03000003_en.png<br />|-- park-cayenne<br />|   |-- src<br />|   |   |-- main<br />|   |   `-- test<br />|   |-- nbactions.xml<br />|   |-- nb-configuration.xml<br />|   `-- pom.xml<br />|-- park-jpa<br />|   |-- src<br />|   |   |-- main<br />|   |   `-- test<br />|   |-- LICENSE.txt<br />|   |-- nbactions.xml<br />|   |-- nb-configuration.xml<br />|   |-- pom.xml<br />|   `-- README.txt<br />|-- park-multi-module<br />|   |-- core<br />|   |   |-- src<br />|   |   |-- nbactions.xml<br />|   |   |-- nb-configuration.xml<br />|   |   |-- pom.xml<br />|   |   `-- README.txt<br />|   |-- web<br />|   |   |-- src<br />|   |   `-- pom.xml<br />|   |-- LICENSE.txt<br />|   |-- pom.xml<br />|   `-- README.txt<br />|-- LICENSE.txt<br />|-- pom.xml<br />`-- README.txt<br /><br /></pre><br /></p><br /><p><br />Veja que marquei o pom do diretório raiz como pai(PARENT), mudando o tipo de empacotamento. Mas você pode perguntar: o que difere um do outro?<br />Bom, primeiro devo dizer que usamos herança em arquivos maven para compartilhar configurações, dependências e até recursos - dê uma boa olhada <a href="http://code.google.com/p/construtor/source/browse/trunk/park-samples/pom.xml">neste pom</a> e você verá ajustes que teria de repetir em praticamente todos os sub-projetos. Já a agregação, usamos para agrupar (óbvio né! :)) projetos que precisam ser construídos juntos - quando executar mvn clean (ou outro comando) no pai, ocorrerá o mesmo nos filhos, tipo efeito cascata.<br /></p><br /><p><br />Para a herança funcionar precisamos adicionar uma seção (tag parent) no pom do sub-projeto:<br /><pre lang="xml"><br />    <modelVersion>4.0.0</modelVersion><br />    <parent><br />        <groupId>com.google.constructor</groupId><br />        <artifactId>park-samples</artifactId><br />        <version>1.0-SNAPSHOT</version><br />    </parent><br />    <artifactId>park-jpa</artifactId><br />    <packaging>war</packaging><br />    <name>Parking Control[JPA]</name><br /></pre><br /></p><br /><p><br />Quando quero agregar projetos, tenho que configurar <strong>o projeto que será o agregador </strong>através da seção módulos (modules):<br /><pre lang="xml"><br />    <parent><br />        <groupId>com.google.constructor</groupId><br />        <artifactId>park-samples</artifactId><br />        <version>1.0-SNAPSHOT</version><br />    </parent>    <br />    <artifactId>park-multi-module</artifactId><br />    <packaging>pom</packaging><br />    <name>Parking Control[MULTI-MODULE]</name><br />    <description><br />        A mult-module project using maven aggregation<br />    </description><br /><br />...<br /><br />   <modules><br />        <module>core</module><br />        <module>web</module><br />    </modules><br /></pre><br />Repare que neste sub-projeto usei os dois conceitos: herança (herdando as configurações do pai) e agregação (este pom agrupa dois outros projetos).<br /></p><br /><p><br />Para os sub-projetos do projeto park-multi-module, poderia adicionar a seção parent como fiz com os outros(apontando para park-samples), mas perderia o benefício da herança.  Então o fiz apontando para o próprio park-multi-module, pois este já herda do raiz. Legal, né! :)<br /></p>