title=Alterne entre versões Java facilmente [update-alternatives] parte 2
date=2012-03-26
type=post
tags=linux,opensuse,internet,java,chromium,banco-do-brasil,update-alternatives
status=published
~~~~~~

<p><br />A um tempo atrás escrevi sobre o <a href="http://linux.die.net/man/8/update-alternatives" title="update-alternatives" target="_blank">utilitário de sistema update-alternatives</a> e mostrei <a href="http://blog.gilbertoca.com/?p=383" title="Alterne entre versões Java facilmente [update-alternatives]" target="_blank">como alternar entre versões do Java usando o mesmo</a>. Naquele mesmo post mostrei que o Java já havia sido instalado e configurado pelo sistema de gerenciamento de pacotes pre-definido - <a href="http://en.opensuse.org/YaST_Software_Management" title="Yast" target="_blank">Yast</a>. Como já é de conhecimento de alguns a <a href="http://www.oracle.com" title="oracle" target="_blank">Oracle</a> mudou a <a href="http://www.hardware.com.br/noticias/2011-08/java-licenca-linux.html" title="mudança de licença Java" target="_blank">forma de licenciamento do Java</a> e com isso a maioria das distribuições - senão todas - optaram por retirar o Java distribuído pela Oracle de seus repositórios. Com isso, se você precisar instalar a versão Java da Oracle terá que fazê-la manualmente.<br /></p><br /><p><br />Antes de começar, quero notificar aos usuários do navegador Chromium que como eles tive dificuldades, no início, para fazê-lo funcionar com Java ao acessar o site do Banco do Brasil. Para confirmar este problema é só fazer uma pesquisa no Google usando a seguinte sentença: <a href="https://www.google.com.br/search?sourceid=chrome&ie=UTF-8&q=chromium+banco+do+brasil" title="chromium banco do brasil" target="_blank">chromium banco do brasil</a>. Então para a felicidade geral nação "chromiumana", relato que esta maneira manual aqui demonstrada soluciona este pequeno problema.<br /></p><br /><p><br />Então vamos lá!<br />Os passos são esses:<br /><ul><br /><li>Baixe a versão RPM do <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" title="oracle java" target="_blank">site da Oracle</a> - baixei a versão jre-7u3-linux-i586.rpm;</li><br /><li>Instale o jre com yast2, zypper, ou com um duplo clique no rpm pelo dolphin ou nautilus:<br /><pre lang="bash"><br />SUGEP265338:~ # zypper in jre-7u3-linux-i586.rpm<br /></pre><br /></li><br /><li>Agora precisamos adicionar esta instalação às alternativas já instaladas, de forma a disponibilizá-la como uma opção:<br /><pre lang="bash"><br />SUGEP265338:~ # update-alternatives --install /usr/bin/java java /usr/java/jre1.7.0_03/bin/java 40<br /></pre><br /></li><br /><li>Faremos o mesmo para o plugin java. Esta opção é muito importante pois estabelece qual versão Java para navegação web estaremos usando:<br /><pre lang="bash"><br />SUGEP265338:~ # update-alternatives --install /usr/lib/browser-plugins/javaplugin.so javaplugin /usr/java/jre1.7.0_03/lib/i386/libnpjp2.so 40<br /></pre><br /></li><br /><li>Bom, agora vem a parte mais fácil que é, como escrevi no primeiro post, alternar entre tais versões:<br /><pre lang="bash"><br />SUGEP265338:~ # update-alternatives --config java<br />There are 2 choices for the alternative java (providing /usr/bin/java).<br /><br />  Selection    Path                                     Priority   Status<br />------------------------------------------------------------<br />* 0            /usr/lib/jvm/jre-1.6.0-openjdk/bin/java   17105     auto mode<br />  1            /usr/java/jre1.7.0_03/bin/java            40        manual mode<br />  2            /usr/lib/jvm/jre-1.6.0-openjdk/bin/java   17105     manual mode<br /><br />Press enter to keep the current choice[*], or type selection number: 1<br />update-alternatives: using /usr/java/jre1.7.0_03/bin/java to provide /usr/bin/java (java) in manual mode.<br />SUGEP265338:~ # <br /></pre><br /></li><br /><li>E finalmente, o mais importante, o plugin para os navegadores web:<br /><pre lang="bash"><br />SUGEP265338:~ # update-alternatives --config javaplugin<br />There are 2 choices for the alternative javaplugin (providing /usr/lib/browser-plugins/javaplugin.so).<br /><br />  Selection    Path                                        Priority   Status<br />------------------------------------------------------------<br />* 0            /usr/lib/IcedTeaPlugin.so                    17106     auto mode<br />  1            /usr/java/jre1.7.0_03/lib/i386/libnpjp2.so   40        manual mode<br />  2            /usr/lib/IcedTeaPlugin.so                    17106     manual mode<br /><br />Press enter to keep the current choice[*], or type selection number: 1<br />update-alternatives: using /usr/java/jre1.7.0_03/lib/i386/libnpjp2.so to provide /usr/lib/browser-plugins/javaplugin.so (javaplugin) in manual mode.<br />SUGEP265338:~ # <br /></pre><br /></li><br /></ul><br /></p><br /><p><br />Pronto! Feche o navegador e faça um teste. Até a próxima!<br /></p><br /><p><strong>Atualização(12/07/2012):</strong> Hoje pela manhã, <a href="https://www.google.com.br/search?q=update-alternatives+for+jdk+7&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:pt-BR:official&client=firefox-a" title="script for registering JDK7 to update-alternatives" target="_blank">procurando por mudanças que torne o script</a> update-alternatives compatível com o jdk 1.7, me <a href="http://odoepner.wordpress.com/2011/10/02/install-jdk7-on-opensuse/" title="Install JDK7 on OpenSuse" target="_blank">deparei com uma forma bem mais simples de instalar manualmente o jdk</a> Oracle. Veja:<br /><pre lang="bash"><br /><br />zypper install jdk-7-linux-x64.rpm<br />cd /usr/java/jdk1.7.0/bin<br />for bin in *; do update-alternatives --install /usr/bin/$bin $bin $(pwd)/$bin 20000; done<br /><br /></pre><br /><p>Agora o javaplugin para o navegador:</p><br /><pre lang="bash"><br />update-alternatives --install /usr/lib64/browser-plugins/javaplugin.so javaplugin /usr/java/jdk1.7.0/jre/lib/amd64/libnpjp2.so 20000<br /></pre><br /></p><br /><p>Usei a versão 64bits mas o procedimento vale também para 32bits.</p>